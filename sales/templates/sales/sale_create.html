{% extends "base.html" %}

{% block title %}NOA Beauty ‚Äî –Ω–æ–≤—ã–π —á–µ–∫{% endblock %}

{% block extra_head %}
    <style>
        h1 { margin-bottom: 20px; }
        
        .basket-row { 
            background: #ffffff; 
            border: 1px solid #e0e0e0; 
            border-radius: 12px; 
            padding: 20px; 
            margin-bottom: 20px; 
            box-shadow: 0 2px 8px rgba(0,0,0,0.08); 
            position: relative;
            transition: box-shadow 0.2s;
        }
        .basket-row:hover {
            box-shadow: 0 4px 12px rgba(0,0,0,0.12);
        }
        
        .pos-number { 
            position: absolute; 
            left: -12px; 
            top: 16px; 
            background: #4a90e2; 
            color: #fff; 
            font-weight: bold; 
            font-size: 0.9em; 
            width: 28px;
            height: 28px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        
        .fields-grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); 
            gap: 16px; 
            align-items: start;
        }
        
        .field-group {
            display: flex;
            flex-direction: column;
            margin-bottom: 0;
        }
        
        .row-label { 
            font-weight: 600; 
            margin-bottom: 6px; 
            font-size: 0.9em;
            color: #333;
        }
        
        select, input[type=number], input[type=text] { 
            font-size: 0.95em; 
            padding: 10px 12px; 
            border-radius: 6px; 
            border: 1px solid #d0d0d0; 
            width: 100%; 
            background: #fff; 
            transition: border-color 0.2s, box-shadow 0.2s;
            box-sizing: border-box;
        }
        
        select:focus, input[type=number]:focus, input[type=text]:focus {
            outline: none;
            border-color: #4a90e2;
            box-shadow: 0 0 0 3px rgba(74, 144, 226, 0.1);
        }
        
        select:read-only, input[readonly] {
            background-color: #f5f5f5;
            cursor: not-allowed;
        }
        
        .remove-btn { 
            background: #e74c3c; 
            color: #fff; 
            border: none; 
            font-size: 1.1em; 
            padding: 8px 16px; 
            border-radius: 6px; 
            cursor: pointer; 
            transition: background 0.2s;
            position: absolute;
            top: 20px;
            right: 20px;
        }
        .remove-btn:hover {
            background: #c0392b;
        }
        
        .add-btn { 
            background: #3498db; 
            color: #fff; 
            font-size: 1em; 
            border-radius: 8px; 
            border: none; 
            padding: 12px 24px; 
            margin: 20px 0; 
            cursor: pointer; 
            font-weight: 600;
            transition: background 0.2s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        .add-btn:hover {
            background: #2980b9;
        }
        
        .summary-section {
            background: #f8f9fa;
            border: 1px solid #e0e0e0;
            border-radius: 12px;
            padding: 20px;
            margin: 24px 0;
        }
        
        .summary { 
            font-size: 1.1em; 
            margin: 0 0 16px 0; 
            font-weight: 600; 
            color: #2c3e50; 
        }
        
        .sumline { 
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #e0e0e0;
        }
        
        .sumline:last-child {
            border-bottom: none;
            font-weight: 600;
            font-size: 1.1em;
            margin-top: 8px;
            padding-top: 12px;
            border-top: 2px solid #2c3e50;
        }
        
        .error { 
            background: #fee;
            color: #c10404; 
            padding: 12px 16px;
            border-radius: 6px;
            border: 1px solid #fcc;
            margin-bottom: 20px;
        }
        
        .payment-section {
            background: #f8f9fa;
            border: 1px solid #e0e0e0;
            border-radius: 12px;
            padding: 20px;
            margin: 24px 0;
        }
        
        .payment-section .field-group {
            margin-bottom: 16px;
        }
        
        button[type=submit] { 
            font-size: 1.1em; 
            padding: 14px 36px; 
            background: #27ae60; 
            color: #fff; 
            border: none; 
            border-radius: 8px; 
            margin-top: 20px; 
            font-weight: 600;
            cursor: pointer;
            transition: background 0.2s;
            width: 100%;
        }
        button[type=submit]:hover {
            background: #229954;
        }
        
        .note { 
            color: #666; 
            font-size: 0.9em; 
            margin-top: 20px;
            padding: 12px;
            background: #f0f0f0;
            border-radius: 6px;
        }
        
        a { 
            color: #3498db; 
            text-decoration: none;
        }
        a:hover {
            text-decoration: underline;
        }
        
        .summary-total { 
            color: #27ae60; 
            font-weight: bold; 
            font-size: 1.2em; 
        }
        
        .summary-discount, .sumline-discount { 
            color: #e74c3c; 
            font-weight: 600; 
        }
        
        .ost-label { 
            font-size: 0.85em; 
            color: #666; 
            margin-top: 4px;
            font-style: italic;
        }
        
        .tara-price { 
            font-size: 0.9em; 
            color: #27ae60; 
            margin-top: 4px;
            font-weight: 500;
        }
        
        .tara-free { 
            color: #888; 
        }
        
        .product-search-input { 
            font-size: 0.9em; 
            padding: 8px 10px; 
            border-radius: 6px; 
            border: 1px solid #d0d0d0; 
            width: 100%; 
            margin-bottom: 6px;
            box-sizing: border-box;
        }
        
        .product-search-input::placeholder { 
            color: #999; 
        }
        
        .form-section-title {
            font-size: 1.1em;
            font-weight: 600;
            margin-bottom: 16px;
            color: #2c3e50;
        }
    </style>
{% endblock %}

{% block extra_js %}
    <script>
        
    let productOptions = {};
    let productStock = {};
    let cosmeticOptions = {};
    let cosmeticStock = {};
    let bottleOptions = {};
    {% for p in perfumes %}productOptions[{{p.id}}] = {price_ml: {{p.price_per_ml}}, price_bottle: {{p.full_bottle_price}}, bottle_ml: {{p.bottle_volume_ml}}, name: "{{p.brand}} {{p.name}}"}; productStock[{{p.id}}] = 999; /* TODO: –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –æ—Å—Ç–∞—Ç–æ–∫ */
    {% endfor %}
    {% for c in cosmetics %}cosmeticOptions[{{c.id}}] = {price: {{c.unit_price}}, name: "{{c.brand}} {{c.name}}"}; cosmeticStock[{{c.id}}] = null;
    {% endfor %}
    {% for b in bottles %}bottleOptions[{{b.id}}] = {price: {{b.price}}, volume_ml: {{b.volume_ml}}, name: "{{b.name}}", is_paid: {{b.is_paid|yesno:'1,0'}}, label: "{{b.name}} {{b.volume_ml}} –º–ª{% if b.is_paid %} ({{b.price}} —Å–æ–º){% else %} (–±–µ—Å–ø–ª–∞—Ç–Ω–æ){% endif %}"};
    {% endfor %}
    function addRow() {
      const container = document.getElementById('basket');
      let idx = container.children.length+1;
      let d = document.createElement('div');
      d.className = 'basket-row';
      d.innerHTML = `
        <div class='pos-number'>#${idx}</div>
        <div class='fields-grid'>
         <div class='field-group'>
           <label class='row-label'>–¢–∏–ø —Ç–æ–≤–∞—Ä–∞*</label>
           <select name="item_type" class="itm-type" onchange="onTypeChange(this)">
             <option value="split">–†–∞—Å–ø–∏–≤ (–ø–æ –º–ª)</option>
             <option value="full">–§–ª–∞–∫–æ–Ω –ø–æ–ª–Ω–æ—Å—Ç—å—é</option>
             <option value="cosmetic">–ö–æ—Å–º–µ—Ç–∏–∫–∞</option>
             <option value="gift">–ü–æ–¥–∞—Ä–æ–∫</option>
           </select>
         </div>
         <div class='field-group perfume-gr'>
           <label class='row-label'>–ü–∞—Ä—Ñ—é–º</label>
           <input type="text"
                  class="product-search-input perfume-search"
                  placeholder="–ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é, –±—Ä–µ–Ω–¥—É –∏–ª–∏ —à—Ç—Ä–∏—Ö–∫–æ–¥—É"
                  oninput="filterPerfumeOptions(this)" />
           <select name="perfume" class="perfume" onchange="onPerfumeChange(this)">
              <option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ –ø–∞—Ä—Ñ—é–º --</option>
              {% for p in perfumes %}
                  <option value="{{p.id}}">
                      {{p.brand}} {{p.name}}{% if p.barcode %} ‚Äî {{p.barcode}}{% endif %}
                  </option>
              {% endfor %}
           </select>
           <span class='ost-label perfume-ost' style='display:none'>–æ—Å—Ç–∞—Ç–æ–∫: n/a</span>
         </div>
         <div class='field-group cosmetic-gr' style='display:none'>
           <label class='row-label'>–ö–æ—Å–º–µ—Ç–∏–∫–∞</label>
           <input type="text"
                  class="product-search-input cosmetic-search"
                  placeholder="–ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é, –±—Ä–µ–Ω–¥—É –∏–ª–∏ —à—Ç—Ä–∏—Ö–∫–æ–¥—É"
                  oninput="filterCosmeticOptions(this)" />
           <select name="cosmetic" class="cosmetic" onchange="onCosmeticChange(this)">
             <option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ –∫–æ—Å–º–µ—Ç–∏–∫—É --</option>
             {% for c in cosmetics %}
                 <option value="{{c.id}}">
                     {{c.brand}} {{c.name}}{% if c.barcode %} ‚Äî {{c.barcode}}{% endif %}
                 </option>
             {% endfor %}
           </select>
           <span class='ost-label cosmetic-ost' style='display:none'>–æ—Å—Ç–∞—Ç–æ–∫: n/a</span>
         </div>
         <div class='field-group ml-group'>
           <label class='row-label'>–†–∞—Å–ø–∏–≤, –º–ª</label>
           <input name="ml_qty" class="ml_qty" type="number" min="0" step="0.1" placeholder="–°–∫–æ–ª—å–∫–æ –º–ª" />
         </div>
         <div class='field-group bottle-group' style="display:none">
           <label class='row-label'>–§–ª–∞–∫–æ–Ω–æ–≤/–®—Ç.*</label>
           <input name="bottle_qty" class="bottle_qty" type="number" min="0" step="1" placeholder="–°–∫–æ–ª—å–∫–æ —à—Ç"/>
         </div>
         <div class='field-group tara-group' style="display:none">
           <label class='row-label'>–¢–∏–ø –∞—Ç–æ–º–∞–π–∑–µ—Ä–∞</label>
           <select name="bottle_type" class="bottle_type" onchange="onTaraChange(this)">
              <option value="">-- –¢–∏–ø –∞—Ç–æ–º–∞–π–∑–µ—Ä–∞ --</option>
              {% for b in bottles %}<option value="{{b.id}}">{{b.name}} {{b.volume_ml}} –º–ª{% if b.is_paid %} ({{b.price}} —Å–æ–º){% else %} (–±–µ—Å–ø–ª–∞—Ç–Ω–æ){% endif %}</option>{% endfor %}
           </select>
           <span class="tara-price" style="display:none;"></span>
         </div>
         <div class='field-group tara-qty-group' style="display:none">
           <label class='row-label'>–ö–æ–ª-–≤–æ –∞—Ç–æ–º–∞–π–∑–µ—Ä–æ–≤</label>
           <input name="atomizer_qty" class="atomizer_qty" type="number" min="0" step="1" placeholder="–°–∫–æ–ª—å–∫–æ —à—Ç" value="1"/>
         </div>
         <div class='field-group'>
           <label class='row-label'>–¶–µ–Ω–∞, —Å–æ–º</label>
           <input name="price" class="price" type="number" min="0" placeholder="–¶–µ–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏" readonly />
         </div>
         <div class='field-group'>
           <label class='row-label'>–°–∫–∏–¥–∫–∞ –Ω–∞ —Ç–æ–≤–∞—Ä, —Å–æ–º</label>
           <input name="item_discount" class="item_discount" type="number" min="0" value="0" placeholder="0" />
         </div>
         <div class='field-group'>
           <button type="button" class="remove-btn" onclick="this.closest('.basket-row').remove(); updatePositionNumbers(); summaryUpdate();" title='–£–¥–∞–ª–∏—Ç—å –ø–æ–∑–∏—Ü–∏—é'>‚Äì</button>
         </div>
        </div>
      `;
      container.appendChild(d);
      summaryUpdate();
    }
    function onTypeChange(sel) {
      let row = sel.closest('.basket-row');
      let type = sel.value;
      row.querySelector('.perfume-gr').style.display = (type !== 'cosmetic') ? '' : 'none';
      row.querySelector('.cosmetic-gr').style.display = (type === 'cosmetic' || type === 'gift') ? '' : 'none';
      row.querySelector('.ml-group').style.display = (type === 'split' || type === 'gift') ? '' : 'none';
      row.querySelector('.bottle-group').style.display = (type !== 'split') ? '' : 'none';
      row.querySelector('.tara-group').style.display = (type === 'split') ? '' : 'none';
      row.querySelector('.tara-qty-group').style.display = (type === 'split') ? '' : 'none';
      if (type === 'gift') {
        row.querySelector('.price').value = 0;
        row.querySelector('.price').readOnly = true;
        row.querySelector('.item_discount').value = 0;
        row.querySelector('.item_discount').readOnly = true;
      } else {
        row.querySelector('.price').readOnly = true;
        row.querySelector('.item_discount').readOnly = false;
      }
      summaryUpdate();
    }
    function filterPerfumeOptions(input) {
      const row = input.closest('.basket-row');
      const select = row.querySelector('select.perfume');
      const term = input.value.toLowerCase().trim();
      if (!term) {
        // –µ—Å–ª–∏ –ø–æ–ª–µ –æ—á–∏—Å—Ç–∏–ª–∏ ‚Äî —Å–±—Ä–∞—Å—ã–≤–∞–µ–º –≤—ã–±–æ—Ä
        select.value = "";
        onPerfumeChange(select);
        return;
      }
      let firstMatch = null;
      const options = Array.from(select.options);
      for (let opt of options) {
        if (!opt.value) continue;  // –ø—Ä–æ–ø—É—Å–∫–∞–µ–º placeholder
        const text = opt.textContent.toLowerCase();
        if (text.includes(term)) {
          firstMatch = opt.value;
          break;
        }
      }
      if (firstMatch) {
        select.value = firstMatch;
        onPerfumeChange(select);
      }
    }
    function onPerfumeChange(sel) {
      let row = sel.closest('.basket-row');
      let type = row.querySelector('.itm-type').value;
      let perfumeId = sel.value;
      let ostSpan = row.querySelector('.perfume-ost');
      if (perfumeId) {
        ostSpan.innerText = '–æ—Å—Ç–∞—Ç–æ–∫: '+(productStock[perfumeId]||'–Ω–µ—Ç');
        ostSpan.style.display = '';
      } else {
        ostSpan.style.display = 'none';
      }
      if (perfumeId && (type === "split" || type === "gift")) {
        row.querySelector('.price').value = type === "gift" ? 0 : productOptions[perfumeId]['price_ml'];
      }
      if (perfumeId && (type === "full" || type === "gift")) {
        if (type === "gift") {
          row.querySelector('.price').value = 0;
        } else {
          row.querySelector('.price').value = productOptions[perfumeId]['price_bottle'];
        }
      }
      summaryUpdate();
    }
    function onTaraChange(sel) {
      let row = sel.closest('.basket-row');
      let btlId = sel.value;
      let lbl = row.querySelector('.tara-price');
      if (btlId && bottleOptions[btlId]) {
        if(bottleOptions[btlId].is_paid) lbl.innerText = '–ü–ª–∞—Ç–Ω—ã–π –∞—Ç–æ–º–∞–π–∑–µ—Ä: '+bottleOptions[btlId].price+' —Å–æ–º/—à—Ç.';
        else lbl.innerText = '–ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π –∞—Ç–æ–º–∞–π–∑–µ—Ä';
        lbl.style.display = '';
      } else {
        lbl.style.display = 'none';
      }
      summaryUpdate();
    }
    function filterCosmeticOptions(input) {
      const row = input.closest('.basket-row');
      const select = row.querySelector('select.cosmetic');
      const term = input.value.toLowerCase().trim();
      if (!term) {
        select.value = "";
        onCosmeticChange(select);
        return;
      }
      let firstMatch = null;
      const options = Array.from(select.options);
      for (let opt of options) {
        if (!opt.value) continue;
        const text = opt.textContent.toLowerCase();
        if (text.includes(term)) {
          firstMatch = opt.value;
          break;
        }
      }
      if (firstMatch) {
        select.value = firstMatch;
        onCosmeticChange(select);
      }
    }
    function onCosmeticChange(sel) {
      let row = sel.closest('.basket-row');
      let cosmeticId = sel.value;
      let ostSpan = row.querySelector('.cosmetic-ost');
      if (cosmeticId) {
        ostSpan.innerText = '–æ—Å—Ç–∞—Ç–æ–∫: '+(cosmeticStock[cosmeticId]||'–Ω–µ—Ç');
        ostSpan.style.display = '';
      } else {
        ostSpan.style.display = 'none';
      }
      if (cosmeticId) {
        let type = row.querySelector('.itm-type').value;
        row.querySelector('.price').value = type === 'gift' ? 0 : cosmeticOptions[cosmeticId]['price'];
      }
      summaryUpdate();
    }
    function summaryUpdate() {
      let rows = document.querySelectorAll('#basket .basket-row');
      let total = 0, discount = 0;
      for (let row of rows) {
        let type = row.querySelector('.itm-type').value;
        let price = +row.querySelector('.price').value || 0;
        let item_discount = +row.querySelector('.item_discount').value || 0;
        let tara_sum = 0;
        if(type == 'split') {
          let tara_id = row.querySelector('.bottle_type').value;
          let atomizer_qty = +row.querySelector('.atomizer_qty').value || 0;
          if (tara_id && bottleOptions[tara_id] && atomizer_qty > 0) {
            tara_sum = bottleOptions[tara_id].is_paid ? bottleOptions[tara_id].price * atomizer_qty : 0;
          }
        }
        let qty = 1;
        if (type == 'split' || type == 'gift') qty = +row.querySelector('.ml_qty').value || 0;
        else if (type == 'cosmetic' || type == 'gift') qty = +row.querySelector('.bottle_qty').value || 0;
        else if (type == 'full' || type == 'gift') qty = +row.querySelector('.bottle_qty').value || 0;
        // –ü–æ–¥–∞—Ä–æ—á–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã –Ω–µ —É—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –≤ –æ–±—â–µ–π —Å—É–º–º–µ
        let sum = 0;
        if (type == 'gift') {
          row.querySelector('.item_discount').value = 0;
          sum = 0;
        } else {
          sum = price * qty + tara_sum - item_discount;
          if (sum < 0) sum = 0;
          total += sum;
          discount += item_discount;
        }
        row.querySelector('.item_discount').style.background = (sum === 0 && (price*qty+tara_sum)>0 && type !== 'gift')?'#ffb5b2':'';
      }
      document.getElementById('summary_total').innerText = total.toLocaleString('ru-RU');
      document.getElementById('summary_discount').innerText = discount.toLocaleString('ru-RU');
      updateFinalTotal();
    }
    function updatePositionNumbers() {
      let positions = document.querySelectorAll('.basket-row .pos-number');
      let i = 1;
      for (let n of positions) n.innerText = '#' + (i++);
    }
    function updateFinalTotal() {
      let saleDiscountInput = document.getElementById('sale_discount');
      if (!saleDiscountInput) return;
      
      let saleDiscountPercent = parseFloat(saleDiscountInput.value) || 0;
      let itemsTotal = parseFloat(document.getElementById('summary_total').innerText.replace(/\s/g, '').replace(',', '.')) || 0;
      let itemsDiscount = parseFloat(document.getElementById('summary_discount').innerText.replace(/\s/g, '').replace(',', '.')) || 0;
      let subtotal = itemsTotal - itemsDiscount;
      
      // –°–∫–∏–¥–∫–∞ –Ω–∞ —á–µ–∫ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫–∞–∫ –ø—Ä–æ—Ü–µ–Ω—Ç –æ—Ç subtotal
      let saleDiscountAmount = Math.round(subtotal * saleDiscountPercent / 100);
      let final = Math.max(0, subtotal - saleDiscountAmount);
      
      document.getElementById('summary_final').innerText = final.toLocaleString('ru-RU');
    }
    
    document.addEventListener('DOMContentLoaded', function() {
      addRow();
      let saleDiscountInput = document.getElementById('sale_discount');
      if (saleDiscountInput) {
        saleDiscountInput.addEventListener('input', updateFinalTotal);
      }
    });
    </script>
{% endblock %}

{% block page_header %}
    <h1 class="h4 mb-1">–ü—Ä–æ–±–∏—Ç—å –Ω–æ–≤—ã–π —á–µ–∫</h1>
    <p class="text-muted mb-0">–î–æ–±–∞–≤—å—Ç–µ –ø–æ–∑–∏—Ü–∏–∏ —Ä–∞—Å–ø–∏–≤–∞, –ø–æ–ª–Ω—ã—Ö —Ñ–ª–∞–∫–æ–Ω–æ–≤ –∏ –∫–æ—Å–º–µ—Ç–∏–∫–∏</p>
{% endblock %}

{% block content %}
    {% if error %}<div class="error">{{ error }}</div>{% endif %}
    
    <form method="post">
        {% csrf_token %}
        
        <div id="basket"></div>
        
        <button type="button" class="add-btn" onclick="addRow()">
            <span>+</span>
            <span>–î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä/–ø–æ–∑–∏—Ü–∏—é</span>
        </button>
        
        <div class="summary-section">
            <div class="form-section-title">–ò—Ç–æ–≥–∏ —á–µ–∫–∞</div>
            <div class="sumline">
                <span>–°—É–º–º–∞ —Ç–æ–≤–∞—Ä–æ–≤:</span>
                <span id="summary_total">0</span> —Å–æ–º
            </div>
            <div class="sumline sumline-discount">
                <span>–°–∫–∏–¥–∫–∞ –Ω–∞ —Ç–æ–≤–∞—Ä—ã:</span>
                <span id="summary_discount">0</span> —Å–æ–º
            </div>
            <div class="sumline">
                <span>–ò—Ç–æ–≥–æ –∫ –æ–ø–ª–∞—Ç–µ:</span>
                <span class="summary-total" id="summary_final">0</span> —Å–æ–º
            </div>
        </div>
        
        <div class="payment-section">
            <div class="form-section-title">–û–ø–ª–∞—Ç–∞</div>
            <div class="field-group">
                <label class="row-label" for="payment_method">–°–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã *</label>
                <select name="payment_method" id="payment_method" required>
                    <option value="">‚Äî –í—ã–±–µ—Ä–∏—Ç–µ —Å–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã ‚Äî</option>
                    {% for method in payment_methods %}
                        <option value="{{ method.id }}">{{ method.name }}</option>
                    {% endfor %}
                </select>
            </div>
            <div class="field-group">
                <label class="row-label" for="sale_discount">–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Å–∫–∏–¥–∫–∞ –Ω–∞ —á–µ–∫ (%)</label>
                <input type="number" min="0" max="100" value="0" name="sale_discount" id="sale_discount" placeholder="0" step="1"/>
            </div>
        </div>
        
        <button type="submit">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏ –ø—Ä–æ–±–∏—Ç—å —á–µ–∫</button>
    </form>
    
    <p class="note">
        üí° –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ç–æ–≤–∞—Ä–æ–≤ ‚Äî —á–µ–∫ —Å –º–Ω–æ–∂–µ—Å—Ç–≤–æ–º –ø–æ–∑–∏—Ü–∏–π. –ò—Ç–æ–≥–∏ –∏ —Å–∫–∏–¥–∫–∏ —Å—á–∏—Ç–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏. 
        <a href="/sales/today/">‚Üê –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ —Å–ø–∏—Å–∫—É –ø—Ä–æ–¥–∞–∂</a>
    </p>
{% endblock %}

